---
layout: post
title: "Snowplow JavaScript Tracker 2.10.0 released with global contexts"
title-short: Snowplow JavaScript Tracker 2.10.0
tags: [snowplow, javascript, global, contexts, guard, error]
author: Mike
category: Releases
permalink: /blog/2018/12/10/snowplow-javascript-tracker-2.10.0-released-with-global-contexts/
discourse: true
---

We are pleased to announce a new release of the [Snowplow JavaScript Tracker][js-tracker]. [Version 2.10.0][2.10.0-tag] introduces global contexts, a set of powerful features for working with contexts. Also included are: more context features for link and form tracking, a new option to prevent exceptions from surfacing, and many other under-the-hood improvements, updates, and bugfixes.

Read on below the fold for:

1. [Global contexts](#global-contexts)
2. [Error-handling](#error-supression)
3. [Dynamic contexts for link and form tracking](#link-form-tracking)
4. [Updates and bug fixes](#updates)
5. [Upgrading](#upgrade)
6. [Documentation and help](#doc)

<!--more-->

<h2 id="global-contexts">1. Global contexts</h2>

This release introduces a set of powerful tracker features for controlling when contexts are added to events. Traditionally, trackers have offered predefined contexts that add contexts to every event when enabled. We refer to these new contexts with expanded capabilities as global contexts because each global context is evaluated when an event is sent.

Global context capabilities:

- adding contexts to every event
- evaluating contexts dynamically, we allow user-supplied callbacks that optionally accept an argument containing important information (schema URI, event payload, event type)
- adding contexts based on an event's schema URI
- adding contexts based on the result of a user-supplied callback

The following methods are added to the tracker:
1. [`addGlobalContexts`][add-global]
2. [`removeGlobalContexts`][remove-global]
3. [`clearGlobalContexts`][clear-global]

For a taste of the functionality, here we can define that a context is only sent for events with the schema vendor `com.acme.marketing`. Notice that `addGlobalContexts` must be supplied with an array of global contexts.

{% highlight javascript %}
let user_context = {
  schema: 'iglu:com.acme.contexts/user_context/jsonschema/1-0-0'
  data: {
    userid: 1234,
    name: 'john doe'
  }
};

// if a global context has a conditional component (in this case, a schema rule set)
// our global context must be supplied as an array, where the first element is
// the conditional part and the context is the second element
let global_context = [
  {accept: 'iglu:com.acme.marketing/\*/jsonschema/1-0-0'},
  user_context
]

window.snowplow('addGlobalContexts', [global_context]);
{% endhighlight %}

Full documentation can be found [here][global-contexts-docs].

<h2 id="error-supression">2. Error-handling</h2>

With this version, by default all exceptions generated by the tracker will not surface.

You can disable this by setting the following value:

{% highlight javascript %}
window.snowplow('addGlobalContexts', [global_context]);
{% endhighlight %}

<h2 id="link-form-tracking">3. Dynamic contexts for link and form tracking</h2>


The feature allows dynamic contexts to be passed in the `context` argument seen in the examples methods below for enabling link and form tracking. For form change events, context generators are passed `(elt, type, value)`, and form submission events are passed `(elt, innerElements)`. Link tracking events pass the source element to the context generator.

{% highlight javascript %}
window.snowplow('enableLinkClickTracking', criterion, pseudoClicks, trackContent, context);
window.snowplow('enableFormTracking', config, context);
{% endhighlight %}

<h2 id="beacon-api">4. Beacon API for event sending</h2>

This release allows you to send events to a collector using the Beacon API, in addition to the traditional `GET` and `POST` options.

This can be set in the argmap value, `beacon`.

{% highlight javascript %}
window.snowplow("newTracker", "cf", "d3rkrsqld9gmqf.cloudfront.net", {
  ...
  beacon: true,
  ...
});
{% endhighlight %}

<h2 id="updates">4. Updates and bug fixes</h2>

Other updates and fixes include:

* Transpile helpers.js and detectors.js ([#693][693])
* Fix default configOptOutCookie value ([#672][#672])
* Remove outdated addClickListener method ([#667][#667])
* Tracking click events on forms ([#579][#579])
* Update tracker script banner ([#684][#684])
* Add new local testing workflow ([#686][#686])
* Clean up indentation of integration test template ([#691][#691])
* Update outdated dependencies ([#685][#685])
* Fix typo in sesname variable ([#671][#671])
* Add Babel to build process ([#665][#665])
* Replace YUI Compressor with UglifyJS ([#687][#687])
* Refresh npm authentication token ([#688][#688])
* Fix log output for failed integration tests ([#689][#689])
* Use modularized imports for lodash ([#502][#502])
* Update npm steps in .travis.yml ([#690][#690])

<h2 id="upgrade">5. Upgrading</h2>

The tracker is available to use here:

```
http(s)://d1fc8wv8zag5ca.cloudfront.net/2.10.0/sp.js
```

As always, we encourage you to self-host your own copy of the tracker.

There are no breaking API changes introduced with this release.

<h2 id="doc">6. Documentation and help</h2>

Check out the JavaScript Tracker's documentation:

* The [setup guide][setup]
* The [full API documentation][docs]

The [v2.10.0 release page][2.10.0-tag] on GitHub has the full list of changes made
in this version.

Finally, if you run into any issues or have any questions, please
[raise an issue][issues] or get in touch with us via [our Discourse forums][forums].

[js-tracker]: https://github.com/snowplow/snowplow-javascript-tracker
[2.10.0-tag]: https://github.com/snowplow/snowplow-javascript-tracker/releases/tag/2.9.0
[setup]: https://github.com/snowplow/snowplow/wiki/Javascript-tracker-setup
[issues]: https://github.com/snowplow/snowplow-javascript-tracker/issues
[forums]: https://discourse.snowplowanalytics.com/
[docs]: https://github.com/snowplow/snowplow/wiki/1-General-parameters-for-the-Javascript-tracker

[cds]: https://github.com/snowplow/snowplow/wiki/2-Specific-event-tracking-with-the-Javascript-tracker#consent-documents
[tcg]: https://github.com/snowplow/snowplow/wiki/2-Specific-event-tracking-with-the-Javascript-tracker#trackConsentGranted
[tcw]: https://github.com/snowplow/snowplow/wiki/2-Specific-event-tracking-with-the-Javascript-tracker#trackConsentWithdrawn

[new-session]: https://github.com/snowplow/snowplow/wiki/1-General-parameters-for-the-Javascript-tracker#state
[transforms]: https://github.com/snowplow/snowplow/wiki/2-Specific-event-tracking-with-the-Javascript-tracker#custom-form-tracking

[580]: https://github.com/snowplow/snowplow-javascript-tracker/issues/580
[602]: https://github.com/snowplow/snowplow-javascript-tracker/issues/602
[605]: https://github.com/snowplow/snowplow-javascript-tracker/issues/605
[621]: https://github.com/snowplow/snowplow-javascript-tracker/issues/621
[625]: https://github.com/snowplow/snowplow-javascript-tracker/issues/625
